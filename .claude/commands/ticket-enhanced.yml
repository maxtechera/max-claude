# Enhanced Ticket Command with Energy Detection
# Part of Solo-Claude v4 Behavioral Engine

Ticket_Enhanced:
  version: "4.0"
  description: "Energy-aware ticket processing with behavioral learning"

  Command_Structure:
    base: "/ticket"
    usage: "/ticket [TICKET-ID] [--mode=local|remote|analyze] [--energy-override] [--delegate] [--pr]"
    
  Energy_Integration:
    pre_execution:
      - check_current_energy_level
      - assess_ticket_complexity
      - calculate_energy_task_alignment
      
    routing_logic: |
      function routeTicket(ticket, energy) {
        const complexity = assessComplexity(ticket);
        const energyLevel = energy.current;
        
        // High complexity + Low energy = Suggest deferral or delegation
        if (complexity === 'high' && energyLevel === 'low') {
          return {
            recommendation: 'defer',
            message: 'Complex ticket detected during low energy. Consider:',
            options: [
              'Schedule for tomorrow morning (peak hours)',
              'Delegate to @solo for automation',
              'Break into smaller subtasks'
            ]
          };
        }
        
        // Perfect alignment
        if (complexity === energyLevel) {
          return {
            recommendation: 'proceed',
            message: 'Optimal energy-task alignment detected!'
          };
        }
        
        // Low complexity + High energy = Batch suggestion
        if (complexity === 'low' && energyLevel === 'high') {
          return {
            recommendation: 'batch',
            message: 'Consider batching with similar tickets for efficiency'
          };
        }
        
        return { recommendation: 'proceed' };
      }

  Pattern_Capture:
    ticket_patterns:
      - ticket_type_frequency
      - completion_time_by_energy
      - success_rate_by_context
      - delegation_patterns
      
    learning_points:
      - optimal_time_for_ticket_type
      - energy_preservation_strategies
      - automation_confidence_growth
      - reframe_effectiveness

  Unconscious_Tracking:
    milestones:
      - first_successful_delegation: "Natural delegation pattern emerging"
      - energy_alignment_streak_5: "Energy awareness becoming intuitive"
      - complex_ticket_mastery: "Complex challenges feel manageable"
      - perfect_routing_week: "Workflow optimization achieved"
    
    reinforcement:
      - subtle_celebration_messages
      - progress_without_pressure
      - natural_skill_development
      - flow_state_indicators

  Identity_Preservation:
    reframes:
      boring_ticket: "Foundation work enabling creative freedom"
      urgent_low_energy: "Opportunity to practice smart delegation"
      complex_challenge: "Chance to level up expertise"
      repetitive_task: "Building unconscious competence"

  Enhanced_Execution:
    workflow:
      1. Energy Check:
         - Current energy level detection
         - Recent pattern analysis
         - Optimal timing suggestion
         
      2. Complexity Assessment:
         - Ticket requirement analysis
         - Historical similar tickets
         - Estimated effort calculation
         
      3. Smart Routing:
         - Energy-complexity alignment
         - Identity-preserving reframe
         - Delegation confidence score
         
      4. Execution Support:
         - Context-aware thinking depth
         - Pattern-based shortcuts
         - Progress tracking
         
      5. Learning Capture:
         - Automatic pattern recording
         - Unconscious skill tracking
         - Compound learning effects

  Integration_Points:
    hooks:
      - pre: energy-aware-routing.hook
      - during: pattern-extraction.hook
      - post: unconscious-progression.hook
    
    mcp_servers:
      - linear: ticket_management
      - github: code_integration
      - notion: knowledge_capture

  Automation_Confidence:
    thresholds:
      certain: 95  # Auto-delegate with confidence
      high: 85     # Suggest delegation strongly
      medium: 70   # Offer as option
      low: 50      # Default to local
      
    factors:
      - clear_acceptance_criteria: +20
      - previous_similar_success: +15
      - well_defined_steps: +10
      - technical_only: +10
      - requires_creativity: -20
      - ambiguous_requirements: -15
      - first_time_task: -10